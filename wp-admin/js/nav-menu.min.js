var wpNavMenu;!function(b){var k=wpNavMenu={options:{menuItemDepthPerLevel:30,globalMaxDepth:11},menuList:void 0,targetList:void 0,menusChanged:!1,isRTL:!("undefined"==typeof isRtl||!isRtl),negateIfRTL:"undefined"!=typeof isRtl&&isRtl?-1:1,init:function(){k.menuList=b("#menu-to-edit"),k.targetList=k.menuList,this.jQueryExtensions(),this.attachMenuEditListeners(),this.setupInputWithDefaultTitle(),this.attachQuickSearchListeners(),this.attachThemeLocationsListeners(),this.attachTabsPanelListeners(),this.attachUnsavedChangesListener(),k.menuList.length&&this.initSortables(),menus.oneThemeLocationNoMenus&&b("#posttype-page").addSelectedToMenu(k.addMenuItemToBottom),this.initManageLocations(),this.initAccessibility(),this.initToggles()},jQueryExtensions:function(){b.fn.extend({menuItemDepth:function(){var e=k.isRTL?this.eq(0).css("margin-right"):this.eq(0).css("margin-left");return k.pxToDepth(e&&-1!=e.indexOf("px")?e.slice(0,-2):0)},updateDepthClass:function(t,n){return this.each(function(){var e=b(this);n=n||e.menuItemDepth(),b(this).removeClass("menu-item-depth-"+n).addClass("menu-item-depth-"+t)})},shiftDepthClass:function(t){return this.each(function(){var e=b(this).menuItemDepth();b(this).removeClass("menu-item-depth-"+e).addClass("menu-item-depth-"+(e+t))})},childMenuItems:function(){var i=b();return this.each(function(){for(var e=b(this),t=e.menuItemDepth(),n=e.next();n.length&&n.menuItemDepth()>t;)i=i.add(n),n=n.next()}),i},shiftHorizontally:function(i){return this.each(function(){var e=b(this),t=e.menuItemDepth(),n=t+i;e.moveHorizontally(n,t)})},moveHorizontally:function(a,s){return this.each(function(){var e=b(this),t=e.childMenuItems(),i=a-s,n=e.find(".is-submenu");e.updateDepthClass(a,s).updateParentMenuItemDBId(),t&&t.each(function(){var e=b(this),t=e.menuItemDepth(),n=t+i;e.updateDepthClass(n,t).updateParentMenuItemDBId()}),0===a?n.hide():n.show()})},updateParentMenuItemDBId:function(){return this.each(function(){var e=b(this),t=e.find(".menu-item-data-parent-id"),n=parseInt(e.menuItemDepth(),10),i=n-1,i=e.prevAll(".menu-item-depth-"+i).first();0===n?t.val(0):t.val(i.find(".menu-item-data-db-id").val())})},hideAdvancedMenuItemFields:function(){return this.each(function(){var e=b(this);b(".hide-column-tog").not(":checked").each(function(){e.find(".field-"+b(this).val()).addClass("hidden-field")})})},addSelectedToMenu:function(a){return 0!==b("#menu-to-edit").length&&this.each(function(){var e=b(this),n={},t=menus.oneThemeLocationNoMenus&&0===e.find(".tabs-panel-active .categorychecklist li input:checked").length?e.find('#page-all li input[type="checkbox"]'):e.find(".tabs-panel-active .categorychecklist li input:checked"),i=/menu-item\[([^\]]*)/;if(a=a||k.addMenuItemToBottom,!t.length)return!1;e.find(".spinner").show(),b(t).each(function(){var e=b(this),t=i.exec(e.attr("name")),t=void 0===t[1]?0:parseInt(t[1],10);this.className&&-1!=this.className.indexOf("add-to-top")&&(a=k.addMenuItemToTop),n[t]=e.closest("li").getItemData("add-menu-item",t)}),k.addItemToMenu(n,a,function(){t.removeAttr("checked"),e.find(".spinner").hide()})})},getItemData:function(t,n){t=t||"menu-item";var i,a={},s=["menu-item-db-id","menu-item-object-id","menu-item-object","menu-item-parent-id","menu-item-position","menu-item-type","menu-item-title","menu-item-url","menu-item-description","menu-item-attr-title","menu-item-target","menu-item-classes","menu-item-xfn"];return(n=n||"menu-item"!=t?n:this.find(".menu-item-data-db-id").val())&&this.find("input").each(function(){var e;for(i=s.length;i--;)"menu-item"==t?e=s[i]+"["+n+"]":"add-menu-item"==t&&(e="menu-item["+n+"]["+s[i]+"]"),this.name&&e==this.name&&(a[s[i]]=this.value)}),a},setItemData:function(e,a,s){return a=a||"menu-item",(s=s||"menu-item"!=a?s:b(".menu-item-data-db-id",this).val())&&this.find("input").each(function(){var n,i=b(this);b.each(e,function(e,t){"menu-item"==a?n=e+"["+s+"]":"add-menu-item"==a&&(n="menu-item["+s+"]["+e+"]"),n==i.attr("name")&&i.val(t)})}),this}})},countMenuItems:function(e){return b(".menu-item-depth-"+e).length},moveMenuItem:function(e,t){var n,i,a=b("#menu-to-edit li"),s=a.length,u=e.parents("li.menu-item"),m=u.childMenuItems(),o=u.getItemData(),r=parseInt(u.menuItemDepth(),10),l=parseInt(u.index(),10),d=u.next(),c=d.childMenuItems(),h=parseInt(d.menuItemDepth(),10)+1,p=u.prev(),f=parseInt(p.menuItemDepth(),10),v=p.getItemData()["menu-item-db-id"];switch(t){case"up":if(i=l-1,0===l)break;0==i&&0!==r&&u.moveHorizontally(0,r),0!==f&&u.moveHorizontally(f,r),(m?n=u.add(m):u).detach().insertBefore(a.eq(i)).updateParentMenuItemDBId();break;case"down":if(m){if(n=u.add(m),(c=0!==(d=a.eq(n.length+l)).childMenuItems().length)&&(i=parseInt(d.menuItemDepth(),10)+1,u.moveHorizontally(i,r)),s===l+n.length)break;n.detach().insertAfter(a.eq(l+n.length)).updateParentMenuItemDBId()}else{if(0!==c.length&&u.moveHorizontally(h,r),s===l+1)break;u.detach().insertAfter(a.eq(l+1)).updateParentMenuItemDBId()}break;case"top":if(0===l)break;(m?n=u.add(m):u).detach().insertBefore(a.eq(0)).updateParentMenuItemDBId();break;case"left":if(0===r)break;u.shiftHorizontally(-1);break;case"right":if(0===l)break;if(o["menu-item-parent-id"]===v)break;u.shiftHorizontally(1)}e.focus(),k.registerChange(),k.refreshKeyboardAccessibility(),k.refreshAdvancedAccessibility()},initAccessibility:function(){var e=b("#menu-to-edit");k.refreshKeyboardAccessibility(),k.refreshAdvancedAccessibility(),e.on("click",".menus-move-up",function(e){k.moveMenuItem(b(this).parents("li.menu-item").find("a.item-edit"),"up"),e.preventDefault()}),e.on("click",".menus-move-down",function(e){k.moveMenuItem(b(this).parents("li.menu-item").find("a.item-edit"),"down"),e.preventDefault()}),e.on("click",".menus-move-top",function(e){k.moveMenuItem(b(this).parents("li.menu-item").find("a.item-edit"),"top"),e.preventDefault()}),e.on("click",".menus-move-left",function(e){k.moveMenuItem(b(this).parents("li.menu-item").find("a.item-edit"),"left"),e.preventDefault()}),e.on("click",".menus-move-right",function(e){k.moveMenuItem(b(this).parents("li.menu-item").find("a.item-edit"),"right"),e.preventDefault()})},refreshAdvancedAccessibility:function(){b(".menu-item-settings .field-move a").css("display","none"),b(".item-edit").each(function(){var e,t,n,i,a=b(this),s=a.closest("li.menu-item").first(),u=s.menuItemDepth(),m=0===u,o=a.closest(".menu-item-handle").find(".menu-item-title").text(),r=parseInt(s.index(),10),l=m?u:parseInt(u-1,10),d=s.prevAll(".menu-item-depth-"+l).first().find(".menu-item-title").text(),c=s.prevAll(".menu-item-depth-"+u).first().find(".menu-item-title").text(),h=b("#menu-to-edit li").length,l=s.nextAll(".menu-item-depth-"+u).length;0!==r&&(e=s.find(".menus-move-up")).prop("title",menus.moveUp).css("display","inline"),0!==r&&m&&(e=s.find(".menus-move-top")).prop("title",menus.moveToTop).css("display","inline"),r+1!==h&&0!==r&&(e=s.find(".menus-move-down")).prop("title",menus.moveDown).css("display","inline"),0===r&&0!==l&&(e=s.find(".menus-move-down")).prop("title",menus.moveDown).css("display","inline"),m||(e=s.find(".menus-move-left"),t=menus.outFrom.replace("%s",d),e.prop("title",menus.moveOutFrom.replace("%s",d)).text(t).css("display","inline")),0!==r&&s.find(".menu-item-data-parent-id").val()!==s.prev().find(".menu-item-data-db-id").val()&&(e=s.find(".menus-move-right"),t=menus.under.replace("%s",c),e.prop("title",menus.moveUnder.replace("%s",c)).text(t).css("display","inline")),i=m?(n=(m=b(".menu-item-depth-0")).index(s)+1,h=m.length,menus.menuFocus.replace("%1$s",o).replace("%2$d",n).replace("%3$d",h)):(u=(i=s.prevAll(".menu-item-depth-"+parseInt(u-1,10)).first()).find(".menu-item-data-db-id").val(),i=i.find(".menu-item-title").text(),u=b('.menu-item .menu-item-data-parent-id[value="'+u+'"]'),n=b(u.parents(".menu-item").get().reverse()).index(s)+1,menus.subMenuFocus.replace("%1$s",o).replace("%2$d",n).replace("%3$s",i)),a.prop("title",i).text(i)})},refreshKeyboardAccessibility:function(){b(".item-edit").off("focus").on("focus",function(){b(this).off("keydown").on("keydown",function(e){var t,n=b(this),i=n.parents("li.menu-item").getItemData();if((37==e.which||38==e.which||39==e.which||40==e.which)&&(n.off("keydown"),1!==b("#menu-to-edit li").length)){switch(t={38:"up",40:"down",37:"left",39:"right"},(t=b("body").hasClass("rtl")?{38:"up",40:"down",39:"left",37:"right"}:t)[e.which]){case"up":k.moveMenuItem(n,"up");break;case"down":k.moveMenuItem(n,"down");break;case"left":k.moveMenuItem(n,"left");break;case"right":k.moveMenuItem(n,"right")}return b("#edit-"+i["menu-item-db-id"]).focus(),!1}})})},initToggles:function(){postboxes.add_postbox_toggles("nav-menus"),columns.useCheckboxesForHidden(),columns.checked=function(e){b(".field-"+e).removeClass("hidden-field")},columns.unchecked=function(e){b(".field-"+e).addClass("hidden-field")},k.menuList.hideAdvancedMenuItemFields(),b(".hide-postbox-tog").click(function(){var e=b(".accordion-container li.accordion-section").filter(":hidden").map(function(){return this.id}).get().join(",");b.post(ajaxurl,{action:"closed-postboxes",hidden:e,closedpostboxesnonce:jQuery("#closedpostboxesnonce").val(),page:"nav-menus"})})},initSortables:function(){var s,a,u,n,m,o,r,l,d,c,h=0,p=k.menuList.offset().left,f=b("body"),v=function(){if(!f[0].className)return 0;var e=f[0].className.match(/menu-max-depth-(\d+)/);return e&&e[1]?parseInt(e[1],10):0}();function g(e){n=e.placeholder.prev(),m=e.placeholder.next(),n[0]==e.item[0]&&(n=n.prev()),m[0]==e.item[0]&&(m=m.next()),o=n.length?n.offset().top+n.height():0,r=m.length?m.offset().top+m.height()/3:0,a=m.length?m.menuItemDepth():0,u=n.length?(e=n.menuItemDepth()+1)>k.options.globalMaxDepth?k.options.globalMaxDepth:e:0}function I(e,t){e.placeholder.updateDepthClass(t,h),h=t}0!==b("#menu-to-edit li").length&&b(".drag-instructions").show(),p+=k.isRTL?k.menuList.width():0,k.menuList.sortable({handle:".menu-item-handle",placeholder:"sortable-placeholder",start:function(e,t){var n,i;k.isRTL&&(t.item[0].style.right="auto"),d=t.item.children(".menu-item-transport"),s=t.item.menuItemDepth(),I(t,s),i=(t.item.next()[0]==t.placeholder[0]?t.item.next():t.item).childMenuItems(),d.append(i),n=d.outerHeight(),n+=0<n?+t.placeholder.css("margin-top").slice(0,-2):0,n+=t.helper.outerHeight(),l=n,n-=2,t.placeholder.height(n),c=s,i.each(function(){var e=b(this).menuItemDepth();c=c<e?e:c}),i=t.helper.find(".menu-item-handle").outerWidth(),i+=k.depthToPx(c-s),i-=2,t.placeholder.width(i),(i=t.placeholder.next()).css("margin-top",l+"px"),t.placeholder.detach(),b(this).sortable("refresh"),t.item.after(t.placeholder),i.css("margin-top",0),g(t)},stop:function(e,t){var n=h-s,i=d.children().insertAfter(t.item),a=t.item.find(".item-title .is-submenu");0<h?a.show():a.hide(),0!=n&&(t.item.updateDepthClass(h),i.shiftDepthClass(n),function(e){var t,n=v;if(0!==e){if(0<e)v<(t=c+e)&&(n=t);else if(e<0&&c==v)for(;!b(".menu-item-depth-"+n,k.menuList).length&&0<n;)n--;f.removeClass("menu-max-depth-"+v).addClass("menu-max-depth-"+n),v=n}}(n)),k.registerChange(),t.item.updateParentMenuItemDBId(),t.item[0].style.top=0,k.isRTL&&(t.item[0].style.left="auto",t.item[0].style.right=0),k.refreshKeyboardAccessibility(),k.refreshAdvancedAccessibility()},change:function(e,t){t.placeholder.parent().hasClass("menu")||(n.length?n.after(t.placeholder):k.menuList.prepend(t.placeholder)),g(t)},sort:function(e,t){var n=t.helper.offset(),i=k.isRTL?n.left+t.helper.width():n.left,i=k.negateIfRTL*k.pxToDepth(i-p);u<i||n.top<o?i=u:i<a&&(i=a),i!=h&&I(t,i),r&&n.top+l>r&&(m.after(t.placeholder),g(t),b(this).sortable("refreshPositions"))}})},initManageLocations:function(){b("#menu-locations-wrap form").submit(function(){window.onbeforeunload=null}),b(".menu-location-menus select").on("change",function(){var e=b(this).closest("tr").find(".locations-edit-menu-link");b(this).find("option:selected").data("orig")?e.show():e.hide()})},attachMenuEditListeners:function(){var t=this;b("#update-nav-menu").bind("click",function(e){if(e.target&&e.target.className)return-1!=e.target.className.indexOf("item-edit")?t.eventOnClickEditLink(e.target):-1!=e.target.className.indexOf("menu-save")?t.eventOnClickMenuSave(e.target):-1!=e.target.className.indexOf("menu-delete")?t.eventOnClickMenuDelete(e.target):-1!=e.target.className.indexOf("item-delete")?t.eventOnClickMenuItemDelete(e.target):-1!=e.target.className.indexOf("item-cancel")?t.eventOnClickCancelLink(e.target):void 0}),b('#add-custom-links input[type="text"]').keypress(function(e){13===e.keyCode&&(e.preventDefault(),b("#submit-customlinkdiv").click())})},setupInputWithDefaultTitle:function(){var i="input-with-default-title";b("."+i).each(function(){var e=b(this),t=e.attr("title"),n=e.val();e.data(i,t),""===n?e.val(t):t!=n&&e.removeClass(i)}).focus(function(){var e=b(this);e.val()==e.data(i)&&e.val("").removeClass(i)}).blur(function(){var e=b(this);""===e.val()&&e.addClass(i).val(e.data(i))}),b(".blank-slate .input-with-default-title").focus()},attachThemeLocationsListeners:function(){var e=b("#nav-menu-theme-locations"),t={action:"menu-locations-save"};t["menu-settings-column-nonce"]=b("#menu-settings-column-nonce").val(),e.find('input[type="submit"]').click(function(){return e.find("select").each(function(){t[this.name]=b(this).val()}),e.find(".spinner").show(),b.post(ajaxurl,t,function(){e.find(".spinner").hide()}),!1})},attachQuickSearchListeners:function(){var n;b(".quick-search").keypress(function(e){var t=b(this);if(13==e.which)return k.updateQuickSearchResults(t),!1;n&&clearTimeout(n),n=setTimeout(function(){k.updateQuickSearchResults(t)},400)}).attr("autocomplete","off")},updateQuickSearchResults:function(e){var t,n,i=e.val();i.length<2||(t=e.parents(".tabs-panel"),n={action:"menu-quick-search","response-format":"markup",menu:b("#menu").val(),"menu-settings-column-nonce":b("#menu-settings-column-nonce").val(),q:i,type:e.attr("name")},b(".spinner",t).show(),b.post(ajaxurl,n,function(e){k.processQuickSearchQueryResponse(e,n,t)}))},addCustomLink:function(e){var t=b("#custom-menu-item-url").val(),n=b("#custom-menu-item-name").val();if(e=e||k.addMenuItemToBottom,""===t||"http://"==t)return!1;b(".customlinkdiv .spinner").show(),this.addLinkToMenu(t,n,e,function(){b(".customlinkdiv .spinner").hide(),b("#custom-menu-item-name").val("").blur(),b("#custom-menu-item-url").val("http://")})},addLinkToMenu:function(e,t,n,i){n=n||k.addMenuItemToBottom,i=i||function(){},k.addItemToMenu({"-1":{"menu-item-type":"custom","menu-item-url":e,"menu-item-title":t}},n,i)},addItemToMenu:function(e,n,i){var a,t=b("#menu").val(),s=b("#menu-settings-column-nonce").val();n=n||function(){},i=i||function(){},a={action:"add-menu-item",menu:t,"menu-settings-column-nonce":s,"menu-item":e},b.post(ajaxurl,a,function(e){var t=b("#menu-instructions");e=b.trim(e),n(e,a),b("li.pending").hide().fadeIn("slow"),b(".drag-instructions").show(),!t.hasClass("menu-instructions-inactive")&&t.siblings().length&&t.addClass("menu-instructions-inactive"),i()})},addMenuItemToBottom:function(e){b(e).hideAdvancedMenuItemFields().appendTo(k.targetList),k.refreshKeyboardAccessibility(),k.refreshAdvancedAccessibility()},addMenuItemToTop:function(e){b(e).hideAdvancedMenuItemFields().prependTo(k.targetList),k.refreshKeyboardAccessibility(),k.refreshAdvancedAccessibility()},attachUnsavedChangesListener:function(){b("#menu-management input, #menu-management select, #menu-management, #menu-management textarea, .menu-location-menus select").change(function(){k.registerChange()}),0!==b("#menu-to-edit").length||0!==b(".menu-location-menus select").length?window.onbeforeunload=function(){if(k.menusChanged)return navMenuL10n.saveAlert}:b("#menu-settings-column").find("input,select").end().find("a").attr("href","#").unbind("click")},registerChange:function(){k.menusChanged=!0},attachTabsPanelListeners:function(){b("#menu-settings-column").bind("click",function(e){var t,n,i=b(e.target);if(!i.hasClass("nav-tab-link"))return i.hasClass("select-all")?(t=/#(.*)$/.exec(e.target.href))&&t[1]?((n=b("#"+t[1]+" .tabs-panel-active .menu-item-title input")).length===n.filter(":checked").length?n.removeAttr("checked"):n.prop("checked",!0),!1):void 0:i.hasClass("submit-add-to-menu")?(k.registerChange(),e.target.id&&"submit-customlinkdiv"==e.target.id?k.addCustomLink(k.addMenuItemToBottom):e.target.id&&-1!=e.target.id.indexOf("submit-")&&b("#"+e.target.id.replace(/submit-/,"")).addSelectedToMenu(k.addMenuItemToBottom),!1):i.hasClass("page-numbers")?(b.post(ajaxurl,e.target.href.replace(/.*\?/,"").replace(/action=([^&]*)/,"")+"&action=menu-get-metabox",function(e){var t,n,i;-1!=e.indexOf("replace-id")&&(t=b.parseJSON(e),n=document.getElementById(t["replace-id"]),i=document.createElement("div"),e=document.createElement("div"),t.markup&&n&&(e.innerHTML=t.markup||"",n.parentNode.insertBefore(i,n),i.parentNode.removeChild(n),i.parentNode.insertBefore(e,i),i.parentNode.removeChild(i)))}),!1):void 0;t=i.data("type"),n=i.parents(".accordion-section-content").first(),b("input",n).removeAttr("checked"),b(".tabs-panel-active",n).removeClass("tabs-panel-active").addClass("tabs-panel-inactive"),b("#"+t,n).removeClass("tabs-panel-inactive").addClass("tabs-panel-active"),b(".tabs",n).removeClass("tabs"),i.parent().addClass("tabs"),b(".quick-search",n).focus(),e.preventDefault()})},eventOnClickEditLink:function(e){var t,n,e=/#(.*)$/.exec(e.href);if(e&&e[1]&&0!==(n=(t=b("#"+e[1])).parent()).length)return n.hasClass("menu-item-edit-inactive")?(t.data("menu-item-data")||t.data("menu-item-data",t.getItemData()),t.slideDown("fast"),n.removeClass("menu-item-edit-inactive").addClass("menu-item-edit-active")):(t.slideUp("fast"),n.removeClass("menu-item-edit-active").addClass("menu-item-edit-inactive")),!1},eventOnClickCancelLink:function(e){var t=b(e).closest(".menu-item-settings");return b(e).closest(".menu-item").removeClass("menu-item-edit-active").addClass("menu-item-edit-inactive"),t.setItemData(t.data("menu-item-data")).hide(),!1},eventOnClickMenuSave:function(){var e="",t=b("#menu-name"),n=t.val();return n&&n!=t.attr("title")&&n.replace(/\s+/,"")?(b("#nav-menu-theme-locations select").each(function(){e+='<input type="hidden" name="'+this.name+'" value="'+b(this).val()+'" />'}),b("#update-nav-menu").append(e),k.menuList.find(".menu-item-data-position").val(function(e){return e+1}),!(window.onbeforeunload=null)):(t.parent().addClass("form-invalid"),!1)},eventOnClickMenuDelete:function(){return!!window.confirm(navMenuL10n.warnDeleteMenu)&&!(window.onbeforeunload=null)},eventOnClickMenuItemDelete:function(e){e=parseInt(e.id.replace("delete-",""),10);return k.removeMenuItem(b("#menu-item-"+e)),k.registerChange(),!1},processQuickSearchQueryResponse:function(e,t,n){var i,a,s,u={},m=document.getElementById("nav-menu-meta"),o=/menu-item[(\[^]\]*/,e=b("<div>").html(e).find("li");if(!e.length)return b(".categorychecklist",n).html("<li><p>"+navMenuL10n.noResultsFound+"</p></li>"),void b(".spinner",n).hide();e.each(function(){if(s=b(this),(i=o.exec(s.html()))&&i[1]){for(a=i[1];m.elements["menu-item["+a+"][menu-item-type]"]||u[a];)a--;u[a]=!0,a!=i[1]&&s.html(s.html().replace(new RegExp("menu-item\\["+i[1]+"\\]","g"),"menu-item["+a+"]"))}}),b(".categorychecklist",n).html(e),b(".spinner",n).hide()},removeMenuItem:function(t){var n=t.childMenuItems();t.addClass("deleting").animate({opacity:0,height:0},350,function(){var e=b("#menu-instructions");t.remove(),n.shiftDepthClass(-1).updateParentMenuItemDBId(),0===b("#menu-to-edit li").length&&(b(".drag-instructions").hide(),e.removeClass("menu-instructions-inactive"))})},depthToPx:function(e){return e*k.options.menuItemDepthPerLevel},pxToDepth:function(e){return Math.floor(e/k.options.menuItemDepthPerLevel)}};b(document).ready(function(){wpNavMenu.init()})}(jQuery);